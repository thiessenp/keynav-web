<!doctype html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <title>Keynav Tests</title>
</head>
<body>

    <h1>Keynav: List Tests</h1>

    <p>Navigate lists with <kbd>up/down/left/right/home/end</kbd>. Activate a list item with <kbd>Enter</kbd> (or Click). Delete a list item with <kbd>del</kbd> and test key combinations with either <kbd>Shift+ArrowRight</kbd> or <kbd>Ctrl+Enter</kbd>.</p>

    <!-- <section aria-labelledby="hotkeytest-label">
        <h2 id="hotkeytest-label">Hotkey Test</h2>
        <p>Trigger below Hotkeys with either <kbd>x</kbd> or <kbd>Ctrl+X</kbd></p>
        <button id="xtest" data-knw-hotkey="x">Hotkey <key>x</key> triggered me</button>
        <button id="ctrlxtest" data-knw-hotkey="ctrl+x">Hotkey <key>ctrl+x</key> triggered me</button>
    </section> -->

    <section aria-labelledby="listSimple1-label">
        <h3 id="listSimple1-label">Simple List using UL and LI's</h3>
        <ul class="listSimple1" aria-labelledby="listSimple1-label">
            <li>List Item A</li>
            <li>List Item B</li>
            <li>List Item C</li>
            <li>List Item D</li>
        </ul>
        <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" class="listSimple1-output"/>
    </section>

    <section aria-labelledby="listSimple2-label">
        <h3 id="listSimple2-label">Simple List using DIV's</h3>
        <div class="listSimple2" aria-labelledby="listSimple2-label">
            <div><span>List Item A</span></div>
            <div><span>List Item B</span></div>
            <div><span>List Item C</span></div>
        </div>
        <br />
        <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" class="listSimple2-output"/>
    </section>

    <section aria-labelledby="listComplex1-label">
        <h3 id="listComplex1-label">Complex List using UL and LI's</h3>
        <ul class="listComplex1-list" aria-labelledby="listComplex1-label" data-knw-list>
            <li>Not In List</li>
            <li tabindex="-1" data-knw-list-item>List Item B</li>
            <li data-knw-list-item>List Item C (start missing tabindex)</li>
            <li tabindex="0" data-knw-list-item>List Item A (start tabindex=0")</li>
        </ul>
        <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" id="keynavUpDown2-output"></output>
    </section>

    <!-- 
        CORS... must load file on Server for modules (ES does XHR req for mods):
        <script type="module" src="../keynav-web.js"></script>
        <script type="module">
            import KeynavWeb from '../index.js';
            ...my code

        Would be a pain why below script ...
     -->
    <script src="../dist/index.js"></script>
    <script>
        console.log('KeynavWeb=', KeynavWeb);
        console.log('KeynavWeb.SimpleList=', KeynavWeb.ListSimple);
        console.log('KeynavWeb.List=', KeynavWeb.List);

        document.addEventListener('DOMContentLoaded', function() {

            // ListSimple: attach basic keynav to a list
            const listSimple1 = new KeynavWeb.ListSimple({
                listEl: document.querySelector('.listSimple1'),
                listItemsSelector: '.listSimple1 > li'
            });
            doSomething({items:'.listSimple1 > li', output:'.listSimple1-output'});
            // ListSimple: same but with nested child items
            const listSimple2 = new KeynavWeb.ListSimple({
                listEl: document.querySelector('.listSimple2'),
                listItemsSelector: '.listSimple2 > div span'
            });
            doSomething({items: '.listSimple2 > div span', output:'.listSimple2-output'});

            // TODO: listComplex1


            // Add keynav (searched from DOM)
            // KeynavWeb.Keynav.init({
                // EXAMPLE: custom callbacks
                // activateCb: function(item) {
                //     console.log('activateCb test, item=', item);
                //     if (!item) { return; }
                //     // Only update if el is not currently active, avoids DOM confusion
                //     if(item.getAttribute('tabindex') !== '0') {
                //         // // Remove any old state to make way for the New Active!
                //         // this.removeActive();
                //         item.setAttribute('tabindex', '0');
                //     }
                // },
                // deactivateCb: function(item) {
                //     console.log('deactivateCb test, item=', item);
                //     if (!item) { return; }
                //     if (item.getAttribute('tabindex') !== '-1') {
                //         item.setAttribute('tabindex', '-1');
                //     }
                // },
                // EXAMPLE: Key overrides
                // customKeys: {
                    // NEXT: {
                    //     keys: ['ArrowRight'],
                    //     // WARNING: run must NOT be an arrow function because would get bound to wrong `this`
                    //     run: function(e) {
                    //         e.preventDefault();
                    //         const next = this.getNext(e.target);
                    //         this.focusCb({item: next});
                    //     }
                    // },
                    // PREV: {
                    //     keys: ['ArrowLeft'],
                    //     run: function(e) {
                    //         e.preventDefault();
                    //         const prev = this.getPrev(e.target);
                    //         this.focusCb({item: prev});
                    //     }
                    // },
            //         TEST: {
            //             keys: ['Shift+ArrowRight', 'Ctrl+Enter'],
            //             run: function(e) {
            //                 alert('TEST! either ' + 'Shift+ArrowRight or ' + 'Ctrl+Enter');
            //             }
            //         }
            //     }
            // });

            //
            // Add custom behavior to test Above hotkeys and keynav
            //



            // // Set some behavior for when a list element is activated
            // const listEl = document.querySelector('.listSimple');
            // const childrenElArr = Array.prototype.slice.call(listEl.children);
            // const outputEl = document.querySelector('#keynavUpDown-output');
            // childrenElArr.forEach(function(el) {
            //     el.addEventListener('focus', function(e) {
            //         console.log('focus', e);
            //     });
            //     el.addEventListener('click', function(e) {
            //         console.log('click', e.target.textContent);
            //         updateOutput(outputEl, 'You activated ' + e.target.textContent);
            //     });
            // });

            // // Copied from above - abstract out if copy again :)
            // const listEl2 = document.querySelector('#keynavUpDown2-list');
            // const childrenElArr2 = Array.prototype.slice.call(listEl2.children);
            // const outputEl2 = document.querySelector('#keynavUpDown2-output');
            // childrenElArr2.forEach(function(el) {
            //     el.addEventListener('focus', function(e) {
            //         console.log('focus', e);
            //     });
            //     el.addEventListener('click', function(e) {
            //         console.log('click', e.target.textContent);
            //         updateOutput(outputEl2, 'You activated ' + e.target.textContent);
            //     });
            // });
        });

        function doSomething({items, output}) {
            let itemEls = Array.from(document.querySelectorAll(items));
            let outputEl = document.querySelector(output);

            itemEls.forEach(function(itemEl) {
                itemEl.addEventListener('click', function(e) {
                    // innerHtml only updated DOM not text it seems?
                    // el.innerHtml = content;
                    // e.target.textContent = content;
                    outputEl.textContent = `You clicked: ${e.target.textContent}`;
                });
            });
        }


        // function updateOutput(el, content) { 
        //     // innerHtml only updated DOM not text it seems?
        //     // el.innerHtml = content;
        //     el.textContent = content;
        // }
    </script>
</body>
</html>