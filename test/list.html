<!doctype html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <title>Keynav-Web: List Tests</title>
</head>
<body>

    <h1>Keynav-Web: List Tests</h1>

    <p>Navigate lists with <kbd>up/down/left/right/home/end</kbd>. Activate a list item with <kbd>Enter</kbd> (or Click). Delete a list item with <kbd>del</kbd> and test key combinations with either <kbd>Shift+ArrowRight</kbd> or <kbd>Ctrl+Enter</kbd>.</p>
    <p>NOTE: ListNav recommended for most cases. It is simpler and uses delegation so lists can be dynamic. ListNavConfigurable is complex, uses static lists but can be comletely customize keys and actions.</p>

    <section aria-labelledby="listSimple1-label">
        <h3 id="listSimple1-label">ListNav using UL and LI's</h3>
        <ul class="listSimple1" aria-labelledby="listSimple1-label">
            <li>List Item A</li>
            <li>List Item B</li>
            <li>List Item C</li>
            <li>List Item D</li>
        </ul>
        <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" class="listSimple1-output"/>
    </section>

    <section aria-labelledby="listSimple2-label">
        <h3 id="listSimple2-label">ListNav using DIV's</h3>
        <div class="listSimple2" aria-labelledby="listSimple2-label">
            <div><span>List Item A</span></div>
            <div><span>List Item B</span></div>
            <div><span>List Item C</span></div>
        </div>
        <br />
        <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" class="listSimple2-output"/>
    </section>

    <!-- <section aria-labelledby="listComplex1-label">
        <h3 id="listComplex1-label">ListNavConfigurable using data-attribute selectors with UL and LI's</h3>
        <ul class="listComplex1-list" aria-labelledby="listComplex1-label" data-knw-list>
            <li>Not In List</li>
            <li tabindex="-1" data-knw-list-item>List Item B</li>
            <li data-knw-list-item>List Item C (start missing tabindex)</li>
            <li tabindex="0" data-knw-list-item>List Item A (start tabindex=0")</li>
        </ul>
        <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" class="listComplex1-output"></output>
    </section>

    <section aria-labelledby="listComplex2-label">
        <h3 id="listComplex2-label">ListNavConfigurable using data-attribute selectors with DIVs</h3>
        <div class="listComplex2-list" aria-labelledby="listComplex2-label" data-knw-list>
            <div data-knw-list-item>List Item A</div>
            <div data-knw-list-item>List Item B</div>
            <div data-knw-list-item>List Item C</div>
        </ul>
        <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" class="listComplex2-output"></output>
    </section> -->

    <!-- 
        CORS... must load file on Server for modules (ES does XHR req for mods):
        <script type="module" src="../keynav-web.js"></script>
        <script type="module">
            import KeynavWeb from '../index.js';
            ...my code

        Would be a pain why below script ...
     -->
    <script src="../dist/index.js"></script>
    <script>
        console.log('KeynavWeb=', KeynavWeb);
        console.log('KeynavWeb.SimpleList=', KeynavWeb.ListNav);
        console.log('KeynavWeb.List=', KeynavWeb.ListNavConfigurable);

        document.addEventListener('DOMContentLoaded', function() {

            // ListSimple: attach basic keynav to a list
            const listSimple1 = new KeynavWeb.ListNav({
                listEl: document.querySelector('.listSimple1'),
                listItemsSelector: '.listSimple1 > li'
            });
            doSomething({items:'.listSimple1 > li', output:'.listSimple1-output'});
 
            // ListSimple: same but with nested child items
            const listSimple2 = new KeynavWeb.ListNav({
                listEl: document.querySelector('.listSimple2'),
                listItemsSelector: '.listSimple2 > div span'
            });
            doSomething({items: '.listSimple2 > div span', output:'.listSimple2-output'});

            // // TODO: listComplex1
            // KeynavWeb.ListNavConfigurableBuilder({
            //     //EXAMPLE: custom callbacks
            //     activateCb: function({item}) {
            //         console.log('Custom Test: activateCb, item=', item);
            //         if (!item) { return; }
            //         // Only update if el is not currently active, avoids DOM confusion
            //         if(item.getAttribute('tabindex') !== '0') {
            //             // // Remove any old state to make way for the New Active!
            //             // this.removeActive();
            //             item.setAttribute('tabindex', '0');
            //         }
            //     },
            //     //EXAMPLE: Key overrides
            //     customKeys: {
            //         NEXT: {
            //             keys: ['ArrowDown', 'ArrowRight'],
            //             // WARNING: run must NOT be an arrow function because would get bound to wrong `this`
            //             run: function(e) {
            //                 e.preventDefault();
            //                 const next = this.getNext(e.target);
            //                 this.focusCb({item: next});
            //                 console.log('Custom Test: ArrowDown/ArrowRight test, next=', next);
            //             }
            //         },
            //         TEST: {
            //             keys: ['Shift+ArrowRight', 'Ctrl+Enter'],
            //             run: function(e) {
            //                 alert('TEST! either ' + 'Shift+ArrowRight or ' + 'Ctrl+Enter');
            //             }
            //         }
            //     }
            // });
            // doSomething({items: '.listComplex1-list [data-knw-list-item]', output:'.listComplex1-output'});
            // doSomething({items: '.listComplex2-list [data-knw-list-item]', output:'.listComplex2-output'});
        });

        //
        // Add custom behavior to test Above hotkeys and keynav
        //
        function doSomething({items, output}) {
            let itemEls = Array.from(document.querySelectorAll(items));
            let outputEl = document.querySelector(output);

            itemEls.forEach(function(itemEl) {
                itemEl.addEventListener('click', function(e) {
                    // innerHtml only updated DOM not text it seems?
                    // el.innerHtml = content;
                    // e.target.textContent = content;
                    outputEl.textContent = `You clicked: ${e.target.textContent}`;
                });
            });
        }
    </script>
</body>
</html>