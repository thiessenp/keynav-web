<!doctype html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <title>test</title>
</head>
<body>

    <h1>Keynav Tests</h1>

    <section aria-labelledby="hotkeytest-label">
        <h1 id="hotkeytest-label">Hotkey Test</h1>
        <button id="xtest" data-knw-hotkey="x">Hotkey <key>x</key> triggered me</button>
        <button id="ctrlxtest" data-knw-hotkey="ctrl+x">Hotkey <key>ctrl+x</key> triggered me</button>
    </section>

    <section aria-labelledby="keynavtest-label">
        <h1 id="keynavtest-label">Keynav Tests</h1>
        <div>
            <h2 id="keynavUpDown-label">List of Items 1 - nav with up or down keys</h2>
            <ul data-knw-keynav-list id="keynavUpDown-list" aria-labelledby="keynavUpDown-label">
                <li tabindex="-1">List Item A</li>
                <li tabindex="-1">List Item B</li>
                <li tabindex="-1">List Item C</li>
                <li tabindex="-1">List Item D</li>
            </ul>
            <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" id="keynavUpDown-output"/>
        </div>
        <div>
            <h2 id="keynavUpDown2-label">List of Items 2 - check multiple lists work</h2>
            <ul data-knw-keynav-list id="keynavUpDown2-list" aria-labelledby="keynavUpDown2-label">
                <li tabindex="0">List Item A</li>
                <li tabindex="-1">List Item B</li>
                <li tabindex="-1">List Item C</li>
                <li tabindex="-1">List Item D</li>
            </ul>
            <output aria-label="List item activated" aria-live="polite" aria-relevant="additions" id="keynavUpDown2-output"/>
        </div>
    </section>

    <!-- CORS... must load file on server for modules (ES does XHR req for mods) -->
    <!-- <script type="module" src="../keynav-web.js"></script> -->

    <!-- <script src="./keynav-web.js"></script> -->

    <!-- type=module or get error Cannot use import statement outside a module -->
    <script type="module">
    
    // <script>

        import * as StarKeynavWeb from '../index.js';
        console.log('StarKeynavWeb', StarKeynavWeb)

        // import KeynavWeb from '../keynav-web.js';
        // console.log('KeynavWeb', KeynavWeb)

        // import {keynav} from '../index.js';
        // console.log('keynav', keynav)

        // import * as ModKeynavWeb from '../src/index.js';
        // console.log('ModKeynavWeb', ModKeynavWeb)


        document.addEventListener('DOMContentLoaded', function() {
            // Add hotkeys (searched from DOM)
            KeynavWeb.hotkeys.init();

            // Add keynav for lists (searched from DOM)
            KeynavWeb.keynav.init();

            //
            // Add custom behavior to test Above hotkeys and keynav
            //
            
            // "Click" Handlers for Triggered Hotkeys
            xtest.addEventListener('click', () => {
                alert('x keyed and triggered me -or- i was clicked')
            });
            ctrlxtest.addEventListener('click', () => {
                alert('ctrl+x keyed and triggered me -or- i was clicked')
            });

            // Set some behavior for when a list element is activated
            const listEl = document.querySelector('#keynavUpDown-list');
            const childrenElArr = [...listEl.children];
            const outputEl = document.querySelector('#keynavUpDown-output');
            childrenElArr.forEach(el => {
                el.addEventListener('focus', e => {
                    console.log('focus', e);
                });
                el.addEventListener('click', e => {
                    console.log('click', e.target.textContent);
                    updateOutput(outputEl, 'You activated ' + e.target.textContent);
                });
            });

            // Copied from above - abstract out if copy again :)
            const listEl2 = document.querySelector('#keynavUpDown2-list');
            const childrenElArr2 = [...listEl2.children];
            const outputEl2 = document.querySelector('#keynavUpDown2-output');
            childrenElArr2.forEach(el => {
                el.addEventListener('focus', e => {
                    console.log('focus', e);
                });
                el.addEventListener('click', e => {
                    console.log('click', e.target.textContent);
                    updateOutput(outputEl2, 'You activated ' + e.target.textContent);
                });
            });
        });

        function updateOutput(el, content) { 
            // innerHtml only updated DOM not text it seems?
            // el.innerHtml = content;
            el.textContent = content;
        }
    </script>
</body>
</html>